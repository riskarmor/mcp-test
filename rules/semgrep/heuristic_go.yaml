rules:
- id: mcp-go-heuristic-trusted-host-only
  message: 'Heuristic: Likely trusted-host-only MCP (stdio, no net.Listener, no auth).'
  severity: INFO
  languages:
  - go
  patterns:
  - pattern-either:
    - pattern: os.Stdin
    - pattern: bufio.NewReader(os.Stdin)
  - pattern-not: net.Listen("tcp", ...)
  - pattern-not: http.ListenAndServe(":$PORT", ...)
  - pattern-not: if req.Header.Get("Authorization") != ""
  metadata:
    deployment_mode: trusted-host-only
    category: heuristic
- id: mcp-go-heuristic-standalone
  message: "Heuristic: MCP Go network server \u2014 likely standalone."
  severity: INFO
  languages:
  - go
  pattern-either:
  - patterns:
    - pattern-either:
      - pattern: net.Listen("tcp", "0.0.0.0:$PORT")
      - pattern: http.ListenAndServe(":$PORT", ...)
    - pattern-either:
      - pattern: if req.Header.Get("Authorization") != ""
      - pattern: apiKey := req.Header.Get("X-API-Key")
  metadata:
    deployment_mode: standalone
    category: heuristic
