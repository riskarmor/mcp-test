# MCP Security Analysis System Environment Configuration Example
# ===============================================================
# Copy this file to .env and update with your actual values

# Database Configuration
DATABASE_URL=postgresql://username:password@localhost:5432/mcp_security
DB_HOST=localhost
DB_PORT=5432
DB_NAME=mcp_security
DB_USER=your_db_user
DB_PASSWORD=your_secure_password
DB_SSL_MODE=prefer
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=40
DB_POOL_TIMEOUT=30

# Security Configuration
MCP_SECURITY_LEVEL=HIGH
MCP_ENCRYPT_DB=true
MCP_ENCRYPT_STORAGE=true
MCP_ENCRYPTION_KEY=generate_secure_key_here
MCP_AUDIT_LOG=true
MCP_SECURITY_MONITORING=true

# GitHub Integration
GITHUB_TOKEN=your_github_token_here
GITHUB_RATE_LIMIT=4500
GITHUB_MAX_REPO_SIZE_MB=500
GITHUB_CLONE_TIMEOUT=300

# Storage Configuration
MCP_STORAGE_PATH=/opt/mcp/storage
MCP_QUARANTINE_PATH=/opt/mcp/storage/quarantine
MCP_CACHE_PATH=/opt/mcp/storage/cache
MCP_TEMP_PATH=/opt/mcp/storage/temp
MCP_ENABLE_MALWARE_SCAN=true
MCP_MAX_STORAGE_GB=100
MCP_CLEANUP_AGE_DAYS=90

# Scanner Configuration
SEMGREP_RULES_PATH=rules/semgrep
SEMGREP_MAX_TARGET_BYTES=10000000
SEMGREP_TIMEOUT=300
SEMGREP_MAX_MEMORY=2000

TRUFFLEHOG_VERIFY_SECRETS=false
TRUFFLEHOG_SCAN_HISTORY=true
TRUFFLEHOG_MAX_DEPTH=500
TRUFFLEHOG_TIMEOUT=600

OSV_OFFLINE_MODE=false
OSV_CHECK_KEV=true
OSV_MIN_CVSS=0.0
OSV_CACHE_DIR=/opt/mcp/storage/cache/osv
OSV_UPDATE_INTERVAL=86400

SBOM_GENERATOR_TYPE=cdxgen
SBOM_OUTPUT_FORMAT=cyclonedx
SBOM_INCLUDE_DEV_DEPS=false
SBOM_DEEP_SCAN=true

# API Configuration
API_HOST=127.0.0.1
API_PORT=8080
API_WORKERS=4
API_REQUEST_TIMEOUT=30
API_MAX_REQUEST_SIZE=10485760
API_CORS_ENABLED=false
API_CORS_ORIGINS=http://localhost:3000

# Rate Limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_PER_MINUTE=60
RATE_LIMIT_PER_HOUR=1000
RATE_LIMIT_PER_DAY=10000

# Authentication
AUTH_ENABLED=true
AUTH_SESSION_TIMEOUT=1800
AUTH_MAX_LOGIN_ATTEMPTS=5
AUTH_LOCKOUT_DURATION=300
AUTH_JWT_SECRET=generate_secure_jwt_secret_here
AUTH_JWT_EXPIRY=3600

# Monitoring & Logging
LOG_LEVEL=INFO
LOG_FILE=/var/log/mcp/mcp_security.log
LOG_MAX_SIZE=100M
LOG_BACKUP_COUNT=10
LOG_FORMAT=json

METRICS_ENABLED=true
METRICS_PORT=9090
METRICS_PATH=/metrics

# Notification Settings
NOTIFICATION_ENABLED=false
NOTIFICATION_WEBHOOK_URL=https://your-webhook-url.com
NOTIFICATION_EMAIL_TO=admin@example.com
NOTIFICATION_SMTP_HOST=smtp.example.com
NOTIFICATION_SMTP_PORT=587
NOTIFICATION_SMTP_USER=smtp_user
NOTIFICATION_SMTP_PASSWORD=smtp_password

# Processing Configuration
MAX_CONCURRENT_SCANS=5
MAX_CONCURRENT_REPOS=10
SCAN_QUEUE_SIZE=100
WORKER_THREADS=4
ASYNC_IO_THREADS=8

# Feature Flags
FEATURE_PARALLEL_SCANNING=true
FEATURE_INCREMENTAL_SCANNING=false
FEATURE_VULNERABILITY_TRACKING=true
FEATURE_TREND_ANALYSIS=true
FEATURE_AUTO_REMEDIATION=false

# Development/Debug Settings
DEBUG=false
TESTING=false
MOCK_EXTERNAL_APIS=false
VERBOSE_LOGGING=false

# Backup Configuration
BACKUP_ENABLED=false
BACKUP_PATH=/backup/mcp
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=30